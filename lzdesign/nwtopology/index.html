<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Create a branded static site from a set of Markdown files to host the documentation of your Open Source or commercial project"><meta name=author content="OCTO CCoE"><link href=https://github.kyndryl.net/OCTO/azure/lzdesign/nwtopology/ rel=canonical><link rel=icon href=../../kyndryl2.png><meta name=generator content="mkdocs-1.2.2, mkdocs-material-7.3.0"><title>4.Network - Kyndrl Solution Guidance for Azure Services</title><link rel=stylesheet href=../../assets/stylesheets/main.55b1b295.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,400,400i,700%7CIBM+Plex+Mono&display=fallback"><style>:root{--md-text-font-family:"IBM Plex Sans";--md-code-font-family:"IBM Plex Mono"}</style><link rel=stylesheet href=../../extra.css><link rel=stylesheet href=../../extra-pagesize.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=blue> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#network-topology-and-connectivity class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Kyndrl Solution Guidance for Azure Services" class="md-header__button md-logo" aria-label="Kyndrl Solution Guidance for Azure Services" data-md-component=logo> <img src=../../kyndryl2.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Kyndrl Solution Guidance for Azure Services </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 4.Network </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.kyndryl.net/OCTO/azure/issues title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> FEEDBACK/ISSUES </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../stratplan/stratplanoverview/ class="md-tabs__link md-tabs__link--active"> Adoption & Design </a> </li> <li class=md-tabs__item> <a href=../../resource-service/compute/ class=md-tabs__link> Azure Resources & Services </a> </li> <li class=md-tabs__item> <a href=../../lzdesignsample1/wldescription/ class=md-tabs__link> Examples - Design & Implementation </a> </li> <li class=md-tabs__item> <a href=../../automation/automation/automation-usecases/ class=md-tabs__link> Operations Automation (IN PROGRESS) </a> </li> <li class=md-tabs__item> <a href=../../about/1authors/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Kyndrl Solution Guidance for Azure Services" class="md-nav__button md-logo" aria-label="Kyndrl Solution Guidance for Azure Services" data-md-component=logo> <img src=../../kyndryl2.png alt=logo> </a> Kyndrl Solution Guidance for Azure Services </label> <div class=md-nav__source> <a href=https://github.kyndryl.net/OCTO/azure/issues title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> FEEDBACK/ISSUES </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> Home <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Home data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../home/scope/ class=md-nav__link> Scope </a> </li> <li class=md-nav__item> <a href=../../home/prereq-learning/ class=md-nav__link> Pre-Requisite Learning </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Adoption & Design <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Adoption & Design" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Adoption & Design </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1 type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1> Strategy & Planning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Strategy & Planning" data-md-level=2> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Strategy & Planning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../stratplan/stratplanoverview/ class=md-nav__link> Strategy & Planning Overview </a> </li> <li class=md-nav__item> <a href=../../stratplan/adoptionstrategy/ class=md-nav__link> Cloud Adoption Strategy </a> </li> <li class=md-nav__item> <a href=../../stratplan/adoptionplan/ class=md-nav__link> Plan </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2 checked> <label class=md-nav__link for=__nav_2_2> Landing Zone Design <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Landing Zone Design" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Landing Zone Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lzdesignoverview/ class=md-nav__link> Overview & Scope </a> </li> <li class=md-nav__item> <a href=../lzdesignapproach/ class=md-nav__link> Design Approach </a> </li> <li class=md-nav__item> <a href=../eaenrolment/ class=md-nav__link> 1.Enterprise Enrollment </a> </li> <li class=md-nav__item> <a href=../iam/ class=md-nav__link> 2.Identity & Access </a> </li> <li class=md-nav__item> <a href=../orgmgmt/ class=md-nav__link> 3.Organization Mgmt </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 4.Network <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> 4.Network </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#network-components-and-functions-in-microsoft-azure-an-overview class=md-nav__link> Network Components and Functions in Microsoft Azure -- An Overview </a> <nav class=md-nav aria-label="Network Components and Functions in Microsoft Azure -- An Overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#azure-virtual-network-vnet class=md-nav__link> Azure Virtual Network (VNet) </a> </li> <li class=md-nav__item> <a href=#subnets-and-ip-addressing class=md-nav__link> Subnets and IP addressing </a> </li> <li class=md-nav__item> <a href=#internet-connectivity class=md-nav__link> Internet Connectivity </a> </li> <li class=md-nav__item> <a href=#nat-gateway class=md-nav__link> NAT Gateway </a> </li> <li class=md-nav__item> <a href=#connectivity-between-vnets class=md-nav__link> Connectivity between VNets </a> </li> <li class=md-nav__item> <a href=#azure-dns class=md-nav__link> Azure DNS </a> </li> <li class=md-nav__item> <a href=#azure-private-dns class=md-nav__link> Azure Private DNS </a> </li> <li class=md-nav__item> <a href=#azure-public-dns class=md-nav__link> Azure Public DNS </a> </li> <li class=md-nav__item> <a href=#network-security-groups-nsgs class=md-nav__link> Network Security Groups (NSGs) </a> </li> <li class=md-nav__item> <a href=#application-security-groups-asgs class=md-nav__link> Application Security Groups (ASGs) </a> </li> <li class=md-nav__item> <a href=#azure-load-balancer class=md-nav__link> Azure Load Balancer </a> </li> <li class=md-nav__item> <a href=#azure-firewall class=md-nav__link> Azure Firewall </a> </li> <li class=md-nav__item> <a href=#azure-bastion-service class=md-nav__link> Azure Bastion Service </a> </li> <li class=md-nav__item> <a href=#azure-ddos-protection class=md-nav__link> Azure DDoS Protection </a> </li> <li class=md-nav__item> <a href=#azure-network-watcher class=md-nav__link> Azure Network Watcher </a> </li> <li class=md-nav__item> <a href=#azure-application-gateway class=md-nav__link> Azure Application Gateway </a> </li> <li class=md-nav__item> <a href=#azure-service-endpoints class=md-nav__link> Azure Service Endpoints </a> </li> <li class=md-nav__item> <a href=#azure-private-link class=md-nav__link> Azure Private Link </a> </li> <li class=md-nav__item> <a href=#dedicated-azure-services-in-vnets-vnet-integration-injection class=md-nav__link> Dedicated Azure services in VNets (VNet Integration) Injection </a> </li> <li class=md-nav__item> <a href=#vpn-gateway class=md-nav__link> VPN Gateway </a> </li> <li class=md-nav__item> <a href=#expressroute-gateway class=md-nav__link> ExpressRoute Gateway </a> </li> <li class=md-nav__item> <a href=#virtual-wan class=md-nav__link> Virtual WAN </a> </li> <li class=md-nav__item> <a href=#user-defined-routes-udr class=md-nav__link> User Defined Routes (UDR) </a> </li> <li class=md-nav__item> <a href=#azure-firewall-manager class=md-nav__link> Azure Firewall Manager </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#azure-networking-use-cases class=md-nav__link> Azure Networking Use Cases </a> </li> <li class=md-nav__item> <a href=#network-topologies class=md-nav__link> Network Topologies </a> <nav class=md-nav aria-label="Network Topologies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hub-spoke-network-topology-using-virtual-network-gateways class=md-nav__link> Hub-Spoke Network Topology using Virtual Network Gateways </a> </li> <li class=md-nav__item> <a href=#hub-spoke-network-topology-with-azure-virtual-wan class=md-nav__link> Hub-Spoke Network Topology with Azure Virtual WAN </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#design-actions-by-solution-architects class=md-nav__link> Design Actions by Solution Architects </a> <nav class=md-nav aria-label="Design Actions by Solution Architects"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1plan-for-ip-addressing class=md-nav__link> 1.Plan for IP Addressing </a> </li> <li class=md-nav__item> <a href=#2-design-dns-for-on-premise-and-azure-resources class=md-nav__link> 2. Design DNS for on-premise and Azure resources </a> </li> <li class=md-nav__item> <a href=#3private-link-and-dns-integration class=md-nav__link> 3.Private Link and DNS Integration </a> </li> <li class=md-nav__item> <a href=#4connectivity-to-azure class=md-nav__link> 4.Connectivity to Azure </a> </li> <li class=md-nav__item> <a href=#5define-an-azure-network-topology class=md-nav__link> 5.Define an Azure network topology </a> </li> <li class=md-nav__item> <a href=#6network-design-with-virtual-wan class=md-nav__link> 6.Network Design with Virtual WAN </a> </li> <li class=md-nav__item> <a href=#7network-design-with-virtual-network-gateways class=md-nav__link> 7.Network Design with Virtual Network gateways </a> </li> <li class=md-nav__item> <a href=#8connectivity-to-azure-paas-services class=md-nav__link> 8.Connectivity to Azure PaaS services </a> </li> <li class=md-nav__item> <a href=#9plan-for-inbound-and-outbound-connectivity class=md-nav__link> 9.Plan for Inbound and Outbound Connectivity </a> </li> <li class=md-nav__item> <a href=#10plan-for-application-delivery class=md-nav__link> 10.Plan for Application Delivery </a> </li> <li class=md-nav__item> <a href=#11plan-for-landing-zone-network-segmentation class=md-nav__link> 11.Plan for Landing Zone Network Segmentation </a> </li> <li class=md-nav__item> <a href=#12plan-for-network-encryption class=md-nav__link> 12.Plan for Network Encryption </a> </li> <li class=md-nav__item> <a href=#13plan-for-traffic-inspection class=md-nav__link> 13.Plan for Traffic Inspection </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../monitoringmgmt/ class=md-nav__link> 5.Monitoring & Mgmt </a> </li> <li class=md-nav__item> <a href=../govcomp/ class=md-nav__link> 6.Governance & Compliance </a> </li> <li class=md-nav__item> <a href=../bcdr/ class=md-nav__link> 7.Backup & DR </a> </li> <li class=md-nav__item> <a href=../platformauto/ class=md-nav__link> 8.Platform Automation </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> Automations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Automations data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Automations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../automation/automation/automation-framework.md class=md-nav__link> Automation Framework </a> </li> <li class=md-nav__item> <a href=../../automation/automation/automation-architecture/ class=md-nav__link> Automation Architecture </a> </li> <li class=md-nav__item> <a href=../../automation/automation/makemanage/ class=md-nav__link> Make Manage Automation </a> </li> <li class=md-nav__item> <a href=../../automation/automation/azure-automationoptions/ class=md-nav__link> Azure Automation Options </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Azure LightHouse <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Azure LightHouse" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Azure LightHouse </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../automation/lighthouse/lh-enableguide/ class=md-nav__link> LightHouse Enablement </a> </li> <li class=md-nav__item> <a href=../../automation/lighthouse/lh-adminguide/ class=md-nav__link> LightHouse Administration </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Azure Resources & Services <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Azure Resources & Services" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Azure Resources & Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../resource-service/compute/ class=md-nav__link> Azure Compute </a> </li> <li class=md-nav__item> <a href=../../resource-service/vmagents/ class=md-nav__link> VM Agents </a> </li> <li class=md-nav__item> <a href=../../resource-service/storage/ class=md-nav__link> Azure Storage </a> </li> <li class=md-nav__item> <a href=../../resource-service/aks/ class=md-nav__link> Azure Kubernetes Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Examples - Design & Implementation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Examples - Design & Implementation" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Examples - Design & Implementation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_1 type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1> Landing Zone Design - Sample Workload 1 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Landing Zone Design - Sample Workload 1" data-md-level=2> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Landing Zone Design - Sample Workload 1 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../lzdesignsample1/wldescription/ class=md-nav__link> Workload Description </a> </li> <li class=md-nav__item> <a href=../../lzdesignsample1/eaenrol/ class=md-nav__link> 1.Enterprise Enrollment & Azure AD Tenants </a> </li> <li class=md-nav__item> <a href=../../lzdesignsample1/idaccess/ class=md-nav__link> 2.Identity & Access Management </a> </li> <li class=md-nav__item> <a href=../../lzdesignsample1/organdmgmt/ class=md-nav__link> 3.Organization & Management Group </a> </li> <li class=md-nav__item> <a href=../../lzdesignsample1/nwtopo/ class=md-nav__link> 4.Network Topology & Connectivity </a> </li> <li class=md-nav__item> <a href=../../lzdesignsample1/monitoringmgmt/ class=md-nav__link> 5.Monitoring & Management </a> </li> <li class=md-nav__item> <a href=../../lzdesignsample1/backupdr/ class=md-nav__link> 6.Business Continuity & Disaster Recovery </a> </li> <li class=md-nav__item> <a href=../../lzdesignsample1/govcomp/ class=md-nav__link> 7.Governance & Compliance </a> </li> <li class=md-nav__item> <a href=../../lzdesignsample1/platformauto/ class=md-nav__link> 8.Platform Automation & DevOps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Virtual WAN - Design and Implementation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Virtual WAN - Design and Implementation" data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Virtual WAN - Design and Implementation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../virtualwan/overview/ class=md-nav__link> Overview and Link to Details </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Operations Automation (IN PROGRESS) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operations Automation (IN PROGRESS)" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Operations Automation (IN PROGRESS) </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_1 type=checkbox id=__nav_5_1> <label class=md-nav__link for=__nav_5_1> Automations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Automations data-md-level=2> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> Automations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../automation/automation/automation-usecases/ class=md-nav__link> Automation UseCases </a> </li> <li class=md-nav__item> <a href=../../automation/automation/automation-architecture/ class=md-nav__link> Automation Architecture </a> </li> <li class=md-nav__item> <a href=../../automation/automation/makemanage/ class=md-nav__link> Make Manage Automation </a> </li> <li class=md-nav__item> <a href=../../automation/automation/azure-automationoptions/ class=md-nav__link> Azure Automation Options </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_2 type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2> Azure LightHouse <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Azure LightHouse" data-md-level=2> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Azure LightHouse </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../automation/lighthouse/lh-enableguide/ class=md-nav__link> LightHouse Enablement </a> </li> <li class=md-nav__item> <a href=../../automation/lighthouse/lh-adminguide/ class=md-nav__link> LightHouse Administration </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> About <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=About data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../about/1authors/ class=md-nav__link> Contributors </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#network-components-and-functions-in-microsoft-azure-an-overview class=md-nav__link> Network Components and Functions in Microsoft Azure -- An Overview </a> <nav class=md-nav aria-label="Network Components and Functions in Microsoft Azure -- An Overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#azure-virtual-network-vnet class=md-nav__link> Azure Virtual Network (VNet) </a> </li> <li class=md-nav__item> <a href=#subnets-and-ip-addressing class=md-nav__link> Subnets and IP addressing </a> </li> <li class=md-nav__item> <a href=#internet-connectivity class=md-nav__link> Internet Connectivity </a> </li> <li class=md-nav__item> <a href=#nat-gateway class=md-nav__link> NAT Gateway </a> </li> <li class=md-nav__item> <a href=#connectivity-between-vnets class=md-nav__link> Connectivity between VNets </a> </li> <li class=md-nav__item> <a href=#azure-dns class=md-nav__link> Azure DNS </a> </li> <li class=md-nav__item> <a href=#azure-private-dns class=md-nav__link> Azure Private DNS </a> </li> <li class=md-nav__item> <a href=#azure-public-dns class=md-nav__link> Azure Public DNS </a> </li> <li class=md-nav__item> <a href=#network-security-groups-nsgs class=md-nav__link> Network Security Groups (NSGs) </a> </li> <li class=md-nav__item> <a href=#application-security-groups-asgs class=md-nav__link> Application Security Groups (ASGs) </a> </li> <li class=md-nav__item> <a href=#azure-load-balancer class=md-nav__link> Azure Load Balancer </a> </li> <li class=md-nav__item> <a href=#azure-firewall class=md-nav__link> Azure Firewall </a> </li> <li class=md-nav__item> <a href=#azure-bastion-service class=md-nav__link> Azure Bastion Service </a> </li> <li class=md-nav__item> <a href=#azure-ddos-protection class=md-nav__link> Azure DDoS Protection </a> </li> <li class=md-nav__item> <a href=#azure-network-watcher class=md-nav__link> Azure Network Watcher </a> </li> <li class=md-nav__item> <a href=#azure-application-gateway class=md-nav__link> Azure Application Gateway </a> </li> <li class=md-nav__item> <a href=#azure-service-endpoints class=md-nav__link> Azure Service Endpoints </a> </li> <li class=md-nav__item> <a href=#azure-private-link class=md-nav__link> Azure Private Link </a> </li> <li class=md-nav__item> <a href=#dedicated-azure-services-in-vnets-vnet-integration-injection class=md-nav__link> Dedicated Azure services in VNets (VNet Integration) Injection </a> </li> <li class=md-nav__item> <a href=#vpn-gateway class=md-nav__link> VPN Gateway </a> </li> <li class=md-nav__item> <a href=#expressroute-gateway class=md-nav__link> ExpressRoute Gateway </a> </li> <li class=md-nav__item> <a href=#virtual-wan class=md-nav__link> Virtual WAN </a> </li> <li class=md-nav__item> <a href=#user-defined-routes-udr class=md-nav__link> User Defined Routes (UDR) </a> </li> <li class=md-nav__item> <a href=#azure-firewall-manager class=md-nav__link> Azure Firewall Manager </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#azure-networking-use-cases class=md-nav__link> Azure Networking Use Cases </a> </li> <li class=md-nav__item> <a href=#network-topologies class=md-nav__link> Network Topologies </a> <nav class=md-nav aria-label="Network Topologies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hub-spoke-network-topology-using-virtual-network-gateways class=md-nav__link> Hub-Spoke Network Topology using Virtual Network Gateways </a> </li> <li class=md-nav__item> <a href=#hub-spoke-network-topology-with-azure-virtual-wan class=md-nav__link> Hub-Spoke Network Topology with Azure Virtual WAN </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#design-actions-by-solution-architects class=md-nav__link> Design Actions by Solution Architects </a> <nav class=md-nav aria-label="Design Actions by Solution Architects"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1plan-for-ip-addressing class=md-nav__link> 1.Plan for IP Addressing </a> </li> <li class=md-nav__item> <a href=#2-design-dns-for-on-premise-and-azure-resources class=md-nav__link> 2. Design DNS for on-premise and Azure resources </a> </li> <li class=md-nav__item> <a href=#3private-link-and-dns-integration class=md-nav__link> 3.Private Link and DNS Integration </a> </li> <li class=md-nav__item> <a href=#4connectivity-to-azure class=md-nav__link> 4.Connectivity to Azure </a> </li> <li class=md-nav__item> <a href=#5define-an-azure-network-topology class=md-nav__link> 5.Define an Azure network topology </a> </li> <li class=md-nav__item> <a href=#6network-design-with-virtual-wan class=md-nav__link> 6.Network Design with Virtual WAN </a> </li> <li class=md-nav__item> <a href=#7network-design-with-virtual-network-gateways class=md-nav__link> 7.Network Design with Virtual Network gateways </a> </li> <li class=md-nav__item> <a href=#8connectivity-to-azure-paas-services class=md-nav__link> 8.Connectivity to Azure PaaS services </a> </li> <li class=md-nav__item> <a href=#9plan-for-inbound-and-outbound-connectivity class=md-nav__link> 9.Plan for Inbound and Outbound Connectivity </a> </li> <li class=md-nav__item> <a href=#10plan-for-application-delivery class=md-nav__link> 10.Plan for Application Delivery </a> </li> <li class=md-nav__item> <a href=#11plan-for-landing-zone-network-segmentation class=md-nav__link> 11.Plan for Landing Zone Network Segmentation </a> </li> <li class=md-nav__item> <a href=#12plan-for-network-encryption class=md-nav__link> 12.Plan for Network Encryption </a> </li> <li class=md-nav__item> <a href=#13plan-for-traffic-inspection class=md-nav__link> 13.Plan for Traffic Inspection </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=network-topology-and-connectivity>Network Topology and Connectivity<a class=headerlink href=#network-topology-and-connectivity title="Permanent link">⚓︎</a></h1> <p>This section covers: <br> - An overview of the various network components and functions available in Microsoft Azure.<br> - A brief discussion of two commonly used network topologies. <br> - Solution guidance, based on key design considerations and best practices surrounding networking and connectivity to, from, and within Microsoft Azure.</p> <h2 id=network-components-and-functions-in-microsoft-azure-an-overview>Network Components and Functions in Microsoft Azure -- An Overview<a class=headerlink href=#network-components-and-functions-in-microsoft-azure-an-overview title="Permanent link">⚓︎</a></h2> <hr> <p>Solution Architects are expected to be familiar with the topics listed at the following link as a prerequisite for the rest of the section -Microsoft Azure <a href=https://docs.microsoft.com/en-us/azure/networking/fundamentals/networking-overview>Networking Fundamentals</a></p> <h3 id=azure-virtual-network-vnet>Azure Virtual Network (VNet)<a class=headerlink href=#azure-virtual-network-vnet title="Permanent link">⚓︎</a></h3> <ul> <li> <p>The VNet is the fundamental building block in Azure cloud that enables communications for various resources such as Virtual Machines (VMs) and Containers.</p> </li> <li> <p>A VNet exists within a subscription and within an Azure region, that is, it cannot span subscriptions or regions. It provides a boundary and isolation for the resources hosted within it.</p> </li> <li> <p>A VNet consists of one or more IP ranges, typically from the private IP ranges specified in RFC 1918. IPv6 address ranges can also be assigned.</p> </li> <li> <p>Azure implements VNets using Software Defined Network (SDN) technologies. This precludes the use of broadcast, multicast and different types of tunnelling.</p> </li> </ul> <p>More details on VNets can be obtained from <a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview>Virtual Network documentation</a>.</p> <h3 id=subnets-and-ip-addressing>Subnets and IP addressing<a class=headerlink href=#subnets-and-ip-addressing title="Permanent link">⚓︎</a></h3> <ul> <li> <p>Each IP address range within a VNet can be used to create subnets. In each subnet that is created, the first four and the last IP addresses are reserved.</p> </li> <li> <p>The first IP address is the network address, the second is used for the default gateway for that subnet, the third and fourth are used for Domain Name Services (DNS) and the last is the broadcast address.</p> </li> <li> <p>A subnet spans the availability zones (AZs) within a region so VMs in different AZs can be on the same subnet.</p> </li> <li> <p>Azure manages the IP address pool for each subnet. Typically, IP addresses are assigned to network interfaces via DHCP. Every time a VM that a network interface is attached to is deallocated and revived, the IP address can change.</p> </li> <li> <p>It is possible to assign a static IP address to a network interface. It is also possible to associate a public IP address with a network interface. This does not mean the public IP address is configured on the network interface. Instead, Azure performs Network Address Translation (NAT) to deliver the traffic destined for the public IP address to the private IP address configured on the network interface.</p> </li> <li> <p>It is possible to assign IPv6 address ranges to subnets but IPv4 is mandatory, given Azure management traffic uses IPv4. Just as for IPv4, public IPv6 addresses can be assigned to network interfaces.</p> </li> </ul> <p>More details on subnets can be obtained from the <a href=https://docs.microsoft.com/en-us/azure/virtual-network/subnet-extension>Subnet documentation</a>.</p> <p>More details on IP addresses can be obtained from the navigation links on <a href=https://docs.microsoft.com/en-us/azure/virtual-network/public-ip-addresses>https://docs.microsoft.com/en-us/azure/virtual-network/public-ip-addresses</a>.</p> <h3 id=internet-connectivity>Internet Connectivity<a class=headerlink href=#internet-connectivity title="Permanent link">⚓︎</a></h3> <ul> <li> <p>Outgoing traffic to the Internet uses public IP addresses that Azure implements. Network and Port Address Translation (NAT/PAT) is used to ensure that corresponding incoming traffic is permitted. As mentioned before, if a public IP address is assigned to a network interface, 1:1 NAT is used instead.</p> </li> <li> <p>Incoming traffic from the Internet can leverage a public IP address assigned to a network interface. However, the recommended approach is to use public IP addresses assigned to Load Balancers. When Load Balancers are used, the outgoing traffic will use the public IP addresses assigned to the Load Balancers. Load Balancers are covered in greater detail in other sections of this document.</p> </li> </ul> <p>More details on Internet Connectivity using NAT can be obtained from <a href=https://docs.microsoft.com/en-us/azure/virtual-network/nat-overview>NAT documentation</a>.</p> <h3 id=nat-gateway>NAT Gateway<a class=headerlink href=#nat-gateway title="Permanent link">⚓︎</a></h3> <p>A NAT Gateway resource specifies several public IP addresses (individual addresses, a pool through a prefix or a combination of the two). It is associated with a VNet. For each subnet the NAT Gateway resource to be used for outbound Internet traffic can then be specified.</p> <p>More details on NAT Gateway resources can be obtained from <a href=https://docs.microsoft.com/en-us/azure/virtual-network/nat-gateway-resource>NAT gateway documentation</a>.</p> <h3 id=connectivity-between-vnets>Connectivity between VNets<a class=headerlink href=#connectivity-between-vnets title="Permanent link">⚓︎</a></h3> <ul> <li> <p>The best possible approach for traffic between VNets is to leverage the Azure backbone via peering.</p> </li> <li> <p>VNets in multiple regions, subscriptions and Azure AD tenants can be peered. Network traffic between peered virtual networks is private.</p> </li> <li> <p>No public Internet, gateways, or encryption is required in the communication between the virtual networks.</p> </li> <li> <p>Resources in either virtual network can directly connect with resources in the peered virtual network. The network latency between virtual machines in peered virtual networks in the same region is the same as the latency within a single virtual network.</p> </li> <li> <p>The network throughput is based on the bandwidth that\'s allowed for the virtual machine, proportionate to its size. There isn\'t any additional restriction on bandwidth within the peering.</p> </li> </ul> <p>More details on VNet peering can be obtained from <a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview>Virtual Network peering documentation</a>.</p> <h3 id=azure-dns>Azure DNS<a class=headerlink href=#azure-dns title="Permanent link">⚓︎</a></h3> <p>This is a hosting service for DNS domains that provides name resolution by using Azure infrastructure. The service can be operated through the Azure Portal, Azure PowerShell cmdlets and the cross-platform Azure CLI. The service is offered via a special IP address (168.63.129.16) that is not routable outside Azure.</p> <h3 id=azure-private-dns>Azure Private DNS<a class=headerlink href=#azure-private-dns title="Permanent link">⚓︎</a></h3> <p>By default, when a VM is created, it is given a unique name in the zone <strong>internal.cloudapp.net</strong> and auto-registered with Azure DNS. This may not acceptable to most clients, and clients would prefer something like hostname.contoso.com or <strong>hostname.azure.contoso.com</strong>. This is achieved using <a href=https://docs.microsoft.com/en-us/azure/dns/private-dns-overview>Private DNS</a> &amp; <a href=https://docs.microsoft.com/en-us/azure/dns/private-dns-privatednszone>Private DNS Zones</a>. </p> <p>Azure Private DNS provides a reliable, secure DNS service to manage and resolve domain names in a virtual network without the need to add a custom DNS solution. By using private DNS zones, you can use your own custom domain names(hostname.azure.contoso.com) rather than the Azure-provided names available today(internal.cloudapp.net)</p> <ul> <li> <p>After creating a Private DNS zone, vNET should be <a href=https://docs.microsoft.com/en-us/azure/dns/private-dns-virtual-network-links>linked</a> to the Private DNS zone. When creating a link between a private DNS zone and a virtual network, you have the option to enable autoregistration. With this setting enabled, the virtual network becomes a registration virtual network for the private DNS zone. A DNS record gets automatically created for any virtual machines you deploy in the virtual network. </p> </li> <li> <p>Note that the auto-registration to the default domain of internal.cloudapp.net always happens in addition to that in the Private DNS zone if any.</p> </li> <li> <p>If the VM is deleted, both auto-registrations are deleted. For the custom auto-registration, when the hostname is changed, the associated DNS record is updated. But for the default auto-registration, the record does not change.</p> </li> <li> <p>One private DNS zone can have multiple resolution virtual networks and a virtual network can have multiple resolution zones associated to it.</p> </li> <li> <p>Azure DNS supports A, AAAA, CNAME, MX, PTR, SOA, SRV, and TXT records. Note that only one custom zone can be linked with a VNet. However, multiple VNets can link to the same custom zone. Name resolution across multiple zones can be performed from within a VNet.</p> </li> <li> <p>It is possible to implement a custom DNS server for the custom zones. If a VM pointing to such a custom DNS server needs to resolve a name in one of the Azure internal zones (such as internal.cloudapp.net), the custom DNS server can be made to forward to Azure DNS server (that is, forward to 168.63.129.16). However, if the custom DNS server is hosted outsize Azure (say the customer premises), it will need to forward to a DNS resolver within the VNet that will then forward to Azure DNS.</p> </li> </ul> <h3 id=azure-public-dns>Azure Public DNS<a class=headerlink href=#azure-public-dns title="Permanent link">⚓︎</a></h3> <ul> <li> <p>For Public DNS Azure DNS provides the name server. User is expected to register its domain and use IP addresses provided by Azure as the name servers. All this can be performed from the Azure Portal, Azure Powershell cmdlets and the cross-platform Azure CLI. Once the domain registration process is completed, A records can be added to the Azure DNS.</p> </li> <li> <p>Note that in the case of split-brain DNS where the same zone is defined in both public and private spaces, resolution is performed using the private space first.</p> </li> </ul> <p>More details on Azure DNS can be obtained from <a href=https://docs.microsoft.com/en-us/azure/dns/dns-overview>Azure DNS documentation</a>.</p> <h3 id=network-security-groups-nsgs>Network Security Groups (NSGs)<a class=headerlink href=#network-security-groups-nsgs title="Permanent link">⚓︎</a></h3> <ul> <li> <p>NSGs are groups of rules that enable filtering of traffic to and from Azure resources within a VNet. The resources include VMs, Azure Kubernetes Services, Azure Container Services, Azure Functions, API Management, Web Apps and so on.</p> </li> <li> <p>Each rule has a name, priority, IP address/IP address range/service tag/application security group, protocol, direction, port range and action (Allow or Deny). The rules are evaluated by priority (lower numbers have higher priority) using the 5-tuple information (source and destination addresses, source and destination ports, protocol) to either allow or deny the traffic. A flow record is established for each connection allowing stateful behaviour.</p> </li> <li> <p>Default rules exist in each security group that allow all traffic within the VNet, all outbound traffic to the Internet, all inbound traffic coming via an Azure Load Balancer, and deny all other incoming and outgoing traffic to and from the VNet. While these rules cannot be deleted, they can be overridden by new rules of higher priority.</p> </li> <li> <p>NSGs are associated with VNet subnets and the network interfaces of VMs. For incoming traffic, the NSGs at the subnet level are evaluated first followed by those at the network interface level. For outgoing traffic, the reverse is true. It is important to know that if an NSG that denies all incoming and outgoing traffic is associated with a subnet, all communications between VMs in that subnet are denied. Typical recommendation is to associate NSGs with either a subnet or the network interface of a VM, but not both.</p> </li> </ul> <p>More details on NSGs can be obtained from <a href=https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview.>NSG documentation</a>.</p> <h3 id=application-security-groups-asgs>Application Security Groups (ASGs)<a class=headerlink href=#application-security-groups-asgs title="Permanent link">⚓︎</a></h3> <p>ASGs are groups of VMs that can either be the source or destination in an NSG rule. The group is created from the network interfaces on a set of VMs that belong in the same VNet.</p> <p>More details on ASGs can be obtained from <a href=https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview#application-security-groups>ASG documentation</a>.</p> <h3 id=azure-load-balancer>Azure Load Balancer<a class=headerlink href=#azure-load-balancer title="Permanent link">⚓︎</a></h3> <ul> <li> <p>Azure Load Balancer operates at layer 4 of the Open Systems Interconnection (OSI) model. The Load Balancer distributes inbound flows that arrive at the Load Balancer\'s front end to backend pool instances. These flows are according to configured load-balancing rules and health probes. The backend pool instances can be Azure Virtual Machines or instances in a virtual machine scale set. Session affinity can be achieved by configuring the load-balancing rules appropriately.</p> </li> <li> <p>Public Load Balancers are used to load balance internet traffic to VMs. A Private or Internal Load Balancer is used to load balance traffic within a VNet or from an on-premises network in a hybrid scenario.</p> </li> <li> <p>The Azure Load Balancer is available as either a Basic or a Standard Load Balancer. The former is limited in features and capacity.</p> </li> <li> <p>A VM in the backend sees incoming traffic with the source IP address of the originator. The response from the VM is routed via the Load Balancer so the IP address of the VM that is used as the source for the response can be replaced by the IP address for the front end of the Load Balancer. This traffic is distinguished from the outgoing connections a VM may initiate. This point is important in the case of a Public Load Balancer. By default, these outgoing connection requests to the Internet are SNATed by NAT gateways. However, if a standard Public Load Balancer is used, there is an option to use the public IP address of the Load Balancer to SNAT the outgoing connections to the Internet from the backend VMs.</p> </li> <li> <p>It is important to note that the Azure Load Balancer is implemented using Software Defined Networking techniques and a distributed set of network elements.</p> </li> <li> <p>Azure Standard Load Balancer helps load-balance all protocol flows on all ports simultaneously when used an Internal Load Balancer via High Availability Ports. High availability (HA) ports are a type of load balancing rule that provides an easy way to load-balance all flows that arrive on all ports of an Internal Standard Load Balancer. The HA ports load-balancing rules help with critical scenarios, such as high availability and scale for network virtual appliances (NVAs) inside virtual networks. The feature can also help when many ports must be load-balanced.</p> </li> <li> <p>The Azure Standard Load Balancer supports multiple IP addresses at the front-end. This allows the use of one instance of the Standard Load Balancer to support multiple workloads that may be reusing the same ports.</p> </li> <li> <p>In a region with Availability Zones, a Standard Load Balancer can be zone redundant. The frontend IP may be used to reach all (non-impacted) backend pool members no matter the zone.</p> </li> <li> <p>One or more availability zones can fail but the data path survives if at least one zone in the region remains healthy. The frontend\'s IP address is served simultaneously by multiple independent infrastructure deployments in multiple availability zones. Any retries or reestablishment will succeed in other zones not affected by the zone failure.</p> </li> </ul> <p>More details on Azure Load Balancer can be obtained from <a href=https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-overview>Azure Load Balancer documentation</a>.</p> <h3 id=azure-firewall>Azure Firewall<a class=headerlink href=#azure-firewall title="Permanent link">⚓︎</a></h3> <ul> <li> <p>Azure Firewall is a managed, cloud-based network security service that protects Azure Virtual Network resources. It supports firewall rules at L3, L4 and L7 layers of the OSI stack.</p> </li> <li> <p>It\'s a fully stateful firewall as a service with built-in high availability and unrestricted cloud scalability.</p> </li> <li> <p>Azure Firewall can be configured during deployment to span multiple Availability Zones for increased availability.</p> </li> <li> <p>Threat intelligence-based filtering can be enabled on the firewall to alert and deny traffic from/to known malicious IP addresses and domains. The IP addresses and domains are sourced from the Microsoft Threat Intelligence feed.</p> </li> <li> <p>SNAT for outgoing and DNAT for incoming traffic along with filtering is supported. Multiple public IP addresses are supported.</p> </li> <li> <p>All Internet traffic can be routed via a network virtual appliance or on-premises edge firewall (forced tunneling) before going to the Internet. The service is fully integrated with Azure Monitor for logging and analytics.</p> </li> </ul> <p>More details on Azure Firewall can be obtained from <a href=https://docs.microsoft.com/en-us/azure/firewall/ >Azure Firewall documentation</a>.</p> <h3 id=azure-bastion-service>Azure Bastion Service<a class=headerlink href=#azure-bastion-service title="Permanent link">⚓︎</a></h3> <ul> <li> <p>Azure Bastion is a service that allows a user to connect to a VM using a browser and the Azure Portal.</p> </li> <li> <p>This service is a fully platform-managed PaaS service that is provisioned inside a VNet and in its own subnet that is named AzureBastionSubnet.</p> </li> <li> <p>It provides secure and seamless RDP/SSH connectivity to all the VMs in the VNet directly from the Azure portal over TLS.</p> </li> <li> <p>The VMs do not need a public IP address, agent, or special client software to support connectivity via the Azure portal and the Azure Bastion service.</p> </li> <li> <p>The Azure Bastion service is hardened internally and kept up to date to provide secure RDP/SSH connectivity and protect against zero-day exploits.</p> </li> <li> <p>NSGs can be configured to permit remote connections (RDP/SSH) only via the Azure Bastion service. This way the VMs are protected from port scanning by rogue and malicious users outside the VNet.</p> </li> </ul> <p>More details on Azure Bastion service can be obtained from <a href=https://docs.microsoft.com/en-us/azure/bastion/bastion-overview>Azure Bastion service documentation</a>.</p> <h3 id=azure-ddos-protection>Azure DDoS Protection<a class=headerlink href=#azure-ddos-protection title="Permanent link">⚓︎</a></h3> <p>This function is available as two SKUs.</p> <ul> <li> <p>Every resource in Azure is protected with no additional cost by Azure\'s infrastructure DDoS (Basic) Protection through always-on traffic monitoring and real-time mitigation.</p> </li> <li> <p><strong>DDoS Protection Basic</strong> requires no user configuration or application changes. DDoS Protection Basic helps protect all Azure services, including PaaS services like Azure DNS.</p> </li> <li> <p><strong>Azure DDoS Protection Standard</strong>, combined with application design best practices, provides enhanced DDoS mitigation features to defend against DDoS attacks. It is automatically tuned to help protect specific Azure resources in a virtual network.</p> </li> <li> <p>Protection is simple to enable on any new or existing virtual network, and it requires no application or resource changes. It has several advantages over the basic service, including logging, alerting, and telemetry.</p> </li> </ul> <p>More details on Azure DDoS Protection can be obtained from <a href=https://docs.microsoft.com/en-us/azure/ddos-protection/ >Azure DDoS Protection Standard documentation</a>.</p> <h3 id=azure-network-watcher>Azure Network Watcher<a class=headerlink href=#azure-network-watcher title="Permanent link">⚓︎</a></h3> <p>Azure Network Watcher provides tools to monitor, diagnose, view metrics, and enable or disable logs for resources in an Azure virtual network. Network Watcher is designed to monitor and repair the network health of IaaS (Infrastructure-as-a-Service) products such as Virtual Machines, Virtual Networks, Application Gateways, and Load Balancers. It is not intended for and will not work for PaaS monitoring or Web analytics.</p> <p>When a VNet is created or updated, Network Watcher will be enabled automatically in the VNet's region. If needed, it can also be enabled in any Azure region manually.</p> <p>The capabilities provided by Network Watcher are described briefly below.</p> <ul> <li> <p>The Connection Monitor checks the communication between a VM and an endpoint and reports regularly on reachability, latency, and changes in network topology between the VM and the endpoint.</p> </li> <li> <p>Network Performance Monitor helps monitor network performance between various points in the network infrastructure. It detects network issues like traffic blackholing, routing errors, and issues that conventional network monitoring methods can't detect.</p> </li> <li> <p>The Topology capability generates a visual diagram of the resources in a virtual network, and the relationships between the resources.</p> </li> <li> <p>The IP Flow Verify capability discovers and reports on security rules that may be inhibiting traffic between two IP endpoints.</p> </li> <li> <p>The Next Hop capability reports on the next hop used to route traffic from one IP address to another thus enabling users to fix routing issues.</p> </li> <li> <p>The Connection Troubleshoot capability is like Connection Monitor except that it runs when explicitly invoked as against periodically.</p> </li> <li> <p>The Capture capability can capture packets to and from a VM. Filtering options and controls such as time and size can be configured. Captured data can be stored in Azure Storage and analyzed using a variety of tools.</p> </li> <li> <p>The VPN Diagnostics capability diagnoses the health of the gateway and its connections and provides detailed information on the cause for any issues.</p> </li> <li> <p>The Security Group View capability shows the security rules applicable to a network interface and is a combination of the rules applicable at both the subnet the network interface is in and the network interface itself.</p> </li> <li> <p>The Network Subscription Limit capability reports on the limits and the actual utilization of network resources for a subscription and region.</p> </li> <li> <p>The NSG Flow Log capability enables logging of the source and destination IP address, port, protocol, and whether traffic was allowed or denied by an NSG.</p> </li> <li> <p>The Diagnostic Logs capability provides a single interface to enable and disable network resource diagnostic logs for any existing network resource that generates a diagnostic log. These logs can be viewed using tools such as Microsoft Power BI and Azure Monitor logs.</p> </li> <li> <p>Network Watcher capability reports on latencies between Azure regions and across Internet service providers.</p> </li> </ul> <p>More details on Azure Network Watcher can be obtained from <a href=https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-monitoring-overview>Azure Network Watcher documentation</a>.</p> <h3 id=azure-application-gateway>Azure Application Gateway<a class=headerlink href=#azure-application-gateway title="Permanent link">⚓︎</a></h3> <p>Azure Application Gateway is a web traffic load balancer for web applications. It makes routing decisions based on additional attributes of an HTTP request, for example URI path or host headers. It is therefore called an application layer or OSI layer 7 load balancer.</p> <p>More details on the Azure Application Gateway can be obtained from <a href=https://docs.microsoft.com/en-us/azure/application-gateway/overview>Azure Application Gateway documentation</a>.</p> <h3 id=azure-service-endpoints>Azure Service Endpoints<a class=headerlink href=#azure-service-endpoints title="Permanent link">⚓︎</a></h3> <p>Azure PaaS services are accessible using pubic IP addresses. This feature allows access to Azure PaaS Services (for example, Azure Storage and SQL Database) from a VNet without having to use the path commonly used by traffic directed to the Internet. The Azure PaaS service retains its public IP address. A route is established over the Azure backbone between the VNet and the Azure PaaS service. Firewall rules can be created for the Azure PaaS service allowing dedicated access to this VNet. However, connectivity to Azure IaaS services from customer premises using service endpoints is not possible.</p> <p>A service endpoint can be configured as part of a subnet configuration.</p> <p>More details can be obtained from <a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-service-endpoints-overview>Virtual Network service endpoints</a>.</p> <h3 id=azure-private-link>Azure Private Link<a class=headerlink href=#azure-private-link title="Permanent link">⚓︎</a></h3> <p>Azure Private Link (Private Endpoint) allows you to access Azure PaaS services over Private IP address within the VNet. It gets a new private IP on your VNet. When you send traffic to PaaS resource, it will always ensure traffic stays within your VNet.</p> <p>This feature enables access to Azure PaaS Services (for example, Azure Storage and SQL Database) and /or customer-owned/partner services hosted in Azure over a private IP address within the VNet. The traffic between the service and the consumer of the service does not go over the Internet.</p> <p>Configuration of the service consists of two steps. First, a private link service needs to be created that enables private connections to an existing service. Next, a private endpoint needs to be created that enables access to the existing service via the private link service.</p> <p>Azure Private Link has integration with Azure Monitor.</p> <p>More details can be obtained from <a href=https://docs.microsoft.com/en-us/azure/private-link/private-link-overview>Azure Private Link documentation</a>.</p> <h3 id=dedicated-azure-services-in-vnets-vnet-integration-injection>Dedicated Azure services in VNets (VNet Integration) <del>Injection</del><a class=headerlink href=#dedicated-azure-services-in-vnets-vnet-integration-injection title="Permanent link">⚓︎</a></h3> <p>This feature enables deployment of Azure PaaS services (for example Azure SQL) and Azure hosted customer-owned/partner services within a subnet of VNet. The service is then accessible within the VNet, across VNets via VNet peering as well as from customer premises.</p> <p>A PaaS service can be injected into a VNet as part of the instantiation of the service.</p> <p>More details on VNet integration <del>injection</del> can be obtained from <a href=https://docs.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services>Integrate Azure services</a>.</p> <h3 id=vpn-gateway>VPN Gateway<a class=headerlink href=#vpn-gateway title="Permanent link">⚓︎</a></h3> <p>A VPN gateway is a type of virtual network gateway that is used to send encrypted traffic between a VNet and an on-premises location over the public Internet. Each VNet can have only one VPN gateway. However, multiple connections can be created to the same VPN gateway with all connections sharing the available gateway bandwidth. The encryption over public Internet limits the performance in terms of bandwidth and latency.</p> <p>A VPN gateway is implemented as a pair of VMs in a dedicated subnet called the gateway subnet. After a VPN gateway is created, an IPsec/IKE VPN tunnel connection between that VPN gateway and another VPN gateway (VNet-to-VNet), or a cross-premises IPsec/IKE VPN tunnel connection between the VPN gateway and an on-premises VPN device (Site-to-Site) can be provisioned. It is also possible to create a Point-to-Site VPN connection (VPN over OpenVPN, IKEv2, or SSTP), which allows connection to the virtual network from a remote location, such as from home.</p> <p>In general, the VPN Gateway is meant to be used for</p> <ul> <li> <p>Development, Test and Laboratory scenarios</p> </li> <li> <p>Small-scale production workloads</p> </li> </ul> <p>More details on VPN gateways can be obtained from <a href=https://docs.microsoft.com/en-us/azure/vpn-gateway/ >VPN Gateway documentation</a>.</p> <h3 id=expressroute-gateway>ExpressRoute Gateway<a class=headerlink href=#expressroute-gateway title="Permanent link">⚓︎</a></h3> <p>An ExpressRoute gateway is a type of virtual network gateway that is used to send traffic between a VNet and an on-premises location over a private link. Each VNet can have only one ExpressRoute gateway. However, multiple ExpressRoute circuits can be created to the same ExpressRoute gateway with all circuits sharing the same available gateway bandwidth. Similarly, multiple VNets can be linked to an ExpressRoute circuit.</p> <p>The private link can either be a point to point physical link such as a fiberoptic cable carrying Ethernet or an any to any fabric such as Multi-Protocol Label Switching (MPLS). This link is established in a Meet-Me location between Microsoft routers and Customer routers, the latter connecting to the Customer on-premises network. The Microsoft routers connect to the Azure backbone. The Microsoft routers, the Customer routers any network fabric between them provided by a Service Provider all constitute an ExpressRoute circuit.</p> <p>The ExpressRoute gateway is implemented as a pair of VMs, each supporting route advertisement and data traffic routing for the ExpressRoute circuit. When an ExpressRoute gateway is configured, it establishes an IP path over the backbone, the Microsoft routers and Customer routers to the on-premises network.</p> <p>ExpressRoute circuits provide two peering paths between on-premises and Microsoft Azure.</p> <ul> <li> <p>Microsoft peering so Azure cloud services are accessible from on-premises.</p> </li> <li> <p>Private peering so VNets are accessible from on-premises.</p> </li> </ul> <p>By default, peering through a location in a particular region allows on-premises access to the Azure cloud services across all the regions in that geopolitical region. ExpressRoute Premium can be enabled to extend connectivity across geopolitical boundaries.</p> <p>ExpressRoute Global Reach enables different on-premises sites to connect to different peering locations and use the Azure backbone to transfer data between sites.</p> <p>Connections over ExpressRoute circuits offer more reliability, faster speeds, and lower latencies. They are ideal for</p> <ul> <li> <p>Data backup and replication</p> </li> <li> <p>Hybrid production workloads spanning on-premise and Azure cloud</p> </li> </ul> <p>More details on ExpressRoute gateways can be obtained from <a href=https://docs.microsoft.com/en-us/azure/expressroute/ >Azure ExpressRoute documentation</a>.</p> <h3 id=virtual-wan>Virtual WAN<a class=headerlink href=#virtual-wan title="Permanent link">⚓︎</a></h3> <p>Virtual WAN is a network service that combines the functions of routing, firewall, encryption, VPN gateway and ExpressRoute gateway. Unlike other solutions for hybrid connectivity, the Virtual WAN network service is managed by Microsoft. In this document, it is covered from the Virtual WAN network topology point view and not as a standalone element. It provides services such as</p> <ul> <li> <p>Branch connectivity (via connectivity automation from Virtual WAN Partner devices such as SD-WAN or VPN CPE)</p> </li> <li> <p>Site-to-site VPN connectivity</p> </li> <li> <p>Remote user VPN (Point-to-site) connectivity</p> </li> <li> <p>Private (ExpressRoute) connectivity</p> </li> <li> <p>Intra-cloud connectivity (transitive connectivity for virtual networks)</p> </li> <li> <p>Routing between two branches one connected via VPN the other via ExpressRoute</p> </li> </ul> <p>More details on Virtual WAN can be obtained from <a href=https://docs.microsoft.com/en-us/azure/virtual-wan/ >Azure Virtual WAN documentation</a>.</p> <h3 id=user-defined-routes-udr>User Defined Routes (UDR)<a class=headerlink href=#user-defined-routes-udr title="Permanent link">⚓︎</a></h3> <p>Azure creates default routes for each subnet in a VNet that allows routing of traffic within the subnets of that VNet as well as to the Internet. In addition, when VNet peering is enabled, routes for all the subnets in the remote VNet are added for each subnet within the local VNet. Also, all the routes advertised by on-premises routers to a virtual network gateway in a VNet are setup for all the subnets in all the VNets that are peered with the VNet hosting the virtual network gateway.</p> <p>It is also possible for the user to set up custom routes for a subnet. Take the case where a Network Virtual Appliance (NVA) that is responsible for routing is installed in a VNet.</p> <p>A custom route for a subnet in a VNet peered with the VNet hosting the NVA can be created by a user. Another situation is where routing between different subnet pairs needs to be setup within a VNet.</p> <p>More details on UDR can be obtained from <a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview>Virtual Network traffic routing documentation</a>.</p> <h3 id=azure-firewall-manager>Azure Firewall Manager<a class=headerlink href=#azure-firewall-manager title="Permanent link">⚓︎</a></h3> <p>Azure Firewall Manager is a security management service that provides central security policy and route management for cloud-based security perimeters. Firewall Manager can provide security management for two network architecture types:</p> <ul> <li> <p><strong>Secure virtual hub</strong> - An Azure Virtual WAN hub with associated security and routing policies. Supports Azure Firewall and third-party Security as a Service (SECaaS) providers.</p> </li> <li> <p><strong>Hub virtual network</strong> -- A standard virtual network with associated security policies. Supports Azure Firewall only.</p> </li> </ul> <p>More details on Azure Firewall Manager can be obtained from <a href=https://docs.microsoft.com/en-us/azure/firewall-manager/overview>Azure Firewall Manager documentation</a>.</p> <h2 id=azure-networking-use-cases>Azure Networking Use Cases<a class=headerlink href=#azure-networking-use-cases title="Permanent link">⚓︎</a></h2> <p>Microsoft Azure supports many networking scenarios. The below table summarized the use cases and associated Azure services.</p> <p><center><img style=height:200;width:150 src=../images/nwtopo-usecases.png></center></p> <h2 id=network-topologies>Network Topologies<a class=headerlink href=#network-topologies title="Permanent link">⚓︎</a></h2> <p>The information presented thus far pertains to the network components and functions in Azure. This sub-section covers the network topologies commonly used to connect virtual networks in Azure and networks on-premises for any-to-any traffic flows.</p> <h3 id=hub-spoke-network-topology-using-virtual-network-gateways>Hub-Spoke Network Topology using Virtual Network Gateways<a class=headerlink href=#hub-spoke-network-topology-using-virtual-network-gateways title="Permanent link">⚓︎</a></h3> <p><center><img style=height:200;width:150 src=../images/nwtopo-hub-spoke.svg></center></p> <p>This architecture is an extension of the VPN and ExpressRoute Gateways proposed in the preceding sections. It combines the VNet-VNet connectivity with the use of virtual gateways to support the connectivity between customer premises and one or more VNets in Azure hosting customer workloads. One VNet acts as the hub that the customer premises connect to and workload VNets are peered with. The benefits of this architecture are</p> <ul> <li> <p>the ability to share network services across multiple workload environments.</p> </li> <li> <p>separation of the centralized management of the network services from the management of the workload environments</p> </li> </ul> <p>By default, each workload VNet can communicate with the customer premises through the Hub VNet but not with other workload VNets. It is however possible to configure the Hub and workload VNets to forward traffic between the workload VNets. While either the VPN gateway or the ExpressRoute gateway can be used, the bandwidth available will be limited by the capabilities of these gateways.</p> <p>A better alternative is to use the Azure Firewall or other Network Virtual Appliance in the Hub VNet that can function as a router between the workload VNets. The virtual gateway is used solely for traffic between the Hub VNet and the customer premises.</p> <p>Note that while the diagram shows VPN and ExpressRoute connections to a virtual network gateway, a VPN gateway supports only S-2-S and P-2-S VPN connections, and an ExpressRoute gateway supports only ExpressRoute connections.</p> <p>The main use cases for this network topology are -</p> <ul> <li> <p>Workloads deployed in different environments, such as development, testing, and production, that require shared services such as DNS, IDS, NTP, or AD DS. Shared services are placed in the hub virtual network, while each environment is deployed to a spoke to maintain isolation.</p> </li> <li> <p>Enterprises that require central control over security aspects, such as a firewall in the hub as a DMZ, and segregated management for the workloads in each spoke.</p> </li> <li> <p>The VPN Gateway can be enabled for data transfers between parts of a workload distributed across either VNets or across on-premises and VNets. Note that such use is not recommended for production environments.</p> </li> <li> <p>The ExpressRoute Gateway can be enabled for data transfers between parts of a workload distributed across either VNets or across on-premises and VNets. It can be used for Production workloads as long as the number of VNets and on-premise sites is limited.</p> </li> </ul> <p>More details on Hub-Spoke Network Topology can be obtained from <a href="https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli">Hub-spoke network topology in Azure documentation</a>.</p> <h3 id=hub-spoke-network-topology-with-azure-virtual-wan>Hub-Spoke Network Topology with Azure Virtual WAN<a class=headerlink href=#hub-spoke-network-topology-with-azure-virtual-wan title="Permanent link">⚓︎</a></h3> <p><center><img style=height:200;width:150 src=../images/nwtopo-virtual-wan.svg></center></p> <p>This architecture is like the previously discussed Hub-Spoke architecture except that in this case</p> <ul> <li> <p>the Hub VNet (called Virtual Hub) uses network components described in the previous section on Azure Virtual WAN. As seen in the above figure, each region can deploy a Virtual Hub. The Virtual Hubs in multiple regions are connected in a full mesh over the Azure Backbone. Thus, workload VNets in Region 2 are reachable from both the customer premises connected to Region 1 and the workload VNets in Region 1.</p> </li> <li> <p>Microsoft manages the Virtual Hub infrastructure. This means that the lifecycle of the Virtual Hub Router, VPN Gateway, ExpressRoute Gateway, Azure Firewall and any other network elements incorporated into the Azure Virtual WAN are all managed by Microsoft.</p> </li> <li> <p>The sizing of the network elements incorporated into the Azure Virtual WAN enables higher bandwidth for data traffic.</p> </li> </ul> <p>Use of the Azure Virtual WAN entails manual configuration. Microsoft partners provide their own Customer Premise Equipment (CPE) NVA that support automatic configuration and optimization in concert with their SD-WAN solutions and that can be installed in the Virtual Hub.</p> <p>The main use cases for this network topology are --</p> <ul> <li> <p>Connectivity among workloads distributed across VNets and on-premise sites with central control and access to shared services.</p> </li> <li> <p>An enterprise requires central control over security aspects, such as a firewall, and requires segregated management for the workloads in each spoke.</p> </li> </ul> <p>More details on Hub-Spoke Network Topology with Azure Virtual WAN can be obtained from <a href=https://docs.microsoft.com/en-us/azure/architecture/networking/hub-spoke-vwan-architecture>Hub-spoke network topology with Azure Virtual WAN documentation</a>.</p> <h2 id=design-actions-by-solution-architects>Design Actions by Solution Architects<a class=headerlink href=#design-actions-by-solution-architects title="Permanent link">⚓︎</a></h2> <p>This sub-section provides guidance at a high level on the key design considerations and best practices for creating a network architecture using the above described network components, functions, and topologies.</p> <h3 id=1plan-for-ip-addressing>1.Plan for IP Addressing<a class=headerlink href=#1plan-for-ip-addressing title="Permanent link">⚓︎</a></h3> <p>It is necessary to determine the IP address ranges to be assigned to on-premise networks, if any, and the VNets in Azure. One key design consideration is to ensure none of the assigned address ranges overlap. Another consideration is to ensure optimal use of the address ranges, particularly in the case of IPv4 addressing. A detailed discussion of the design considerations and recommendations can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing>Plan for IP Addressing documentation</a>.</p> <h3 id=2-design-dns-for-on-premise-and-azure-resources>2. Design DNS for on-premise and Azure resources<a class=headerlink href=#2-design-dns-for-on-premise-and-azure-resources title="Permanent link">⚓︎</a></h3> <p>DNS can be configured to either leverage on-premise DNS infrastructure or to leverage Azure cloud. The earlier section on DNS provides a brief description of DNS support in Azure and links to more detailed information. One design consideration is that the maximum number of private DNS zones to which a virtual network can link with auto-registration is one. Another design consideration is that the maximum number of private DNS zones to which a virtual network can link is 1,000 all without auto-registration enabled. A detailed discussion of the design considerations and recommendations can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/dns-for-on-premises-and-azure-resources>DNS for on-premises and Azure resources documentation</a>.</p> <h3 id=3private-link-and-dns-integration>3.Private Link and DNS Integration<a class=headerlink href=#3private-link-and-dns-integration title="Permanent link">⚓︎</a></h3> <p>The Private Link feature as well as private DNS have been discussed in previous sub-sections. Private DNS allows a VNet to be associated with a custom zone. However, when the customer wishes to associate a private DNS A record with such customer defined PaaS service, there could be challenges in terms of accessibility given the implementation approach of the private DNS. Details of how such custom PaaS services can be provided A records in the private DNS can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/private-link-and-dns-integration-at-scale>Private Link and DNS integration at scale documentation</a>.</p> <h3 id=4connectivity-to-azure>4.Connectivity to Azure<a class=headerlink href=#4connectivity-to-azure title="Permanent link">⚓︎</a></h3> <p>In terms of data traffic, ExpressRoute is the preferred approach to connecting on-premises to Azure. ExpressRoute has several characteristics such as peering for Microsoft cloud SaaS/PaaS services and Global Reach that need to be considered along with limitations such as needing a peering location. Redundancy can be achieved through dual circuits across different peering locations and use of BGP. A detailed discussion of the design considerations and recommendations can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/connectivity-to-azure>Connectivity to Azure documentation</a>.</p> <h3 id=5define-an-azure-network-topology>5.Define an Azure network topology<a class=headerlink href=#5define-an-azure-network-topology title="Permanent link">⚓︎</a></h3> <p>Network topology is a critical element of the solution design because it defines how applications can communicate with each other. Two network topologies have been presented in the previous section. The Hub-Spoke network topology with Virtual Network gateways is to be mainly used where there are only a few on-premise sites to connect to Azure. The Hub-Spoke network topology with Virtual WAN is to be mainly used where there are many regional and branch locations to be connected to Azure. Other decision criteria can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/define-an-azure-network-topology>Define an Azure network topology documentation</a>.</p> <h3 id=6network-design-with-virtual-wan>6.Network Design with Virtual WAN<a class=headerlink href=#6network-design-with-virtual-wan title="Permanent link">⚓︎</a></h3> <p>Virtual WAN is a managed service with unique features such as any-to-any connectivity across VNets, regional sites and branch sites, routing between VPN connected and ExpressRoute connected sites, Firewall, and encryption. But there are certain limitations such as inability to support NVAs and UDRs. The detailed design considerations and recommendations for Virtual WAN topology can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/virtual-wan-network-topology>Virtual WAN network topology (Microsoft-managed) documentation</a>.</p> <h3 id=7network-design-with-virtual-network-gateways>7.Network Design with Virtual Network gateways<a class=headerlink href=#7network-design-with-virtual-network-gateways title="Permanent link">⚓︎</a></h3> <p>Virtual Network gateways have certain features and limitations that need to be considered during network design. While a hup-spoke topology with Virtual Network gateways provides flexibility in terms of NVAs and UDR, the limitations in terms of bandwidth and connections need to be considered as well. The detailed design considerations and recommendations for Virtual Network gateways can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/traditional-azure-networking-topology>Traditional Azure networking topology documentation</a>.</p> <h3 id=8connectivity-to-azure-paas-services>8.Connectivity to Azure PaaS services<a class=headerlink href=#8connectivity-to-azure-paas-services title="Permanent link">⚓︎</a></h3> <p>Often, there is a requirement to avoid access to Azure PaaS and customer defined PaaS services through public IP addresses. The detailed design considerations and recommendations for use of techniques such as VNet injection and Private Link can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/connectivity-to-azure-paas-services>Connectivity to Azure PaaS services documentation</a>.</p> <h3 id=9plan-for-inbound-and-outbound-connectivity>9.Plan for Inbound and Outbound Connectivity<a class=headerlink href=#9plan-for-inbound-and-outbound-connectivity title="Permanent link">⚓︎</a></h3> <p>Internet connectivity, Azure Firewall and Application Gateway were discussed briefly in preceding sub-sections. Azure Firewall and Application Gateway are fully managed services so there are no operational or management costs. NVAs can be used instead if special functionality that these Azure services do not provide are needed. The detailed design considerations and recommendations for the use of these components to comprehensively secure Internet traffic can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-inbound-and-outbound-internet-connectivity>Plan for inbound and outbound internet connectivity documentation</a>.</p> <h3 id=10plan-for-application-delivery>10.Plan for Application Delivery<a class=headerlink href=#10plan-for-application-delivery title="Permanent link">⚓︎</a></h3> <p>The Azure Load Balancer and Application Gateway were discussed briefly in previous sub-sections. Azure Application Gateway allows the secure delivery of HTTP/S applications at a regional level while Azure Front Door allows the secure delivery of highly available HTTP/S applications across Azure regions. The detailed design considerations and recommendations for the use of these components to deliver internal and external facing applications in a secure, highly scalable and highly available manner can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-app-delivery>Plan for application delivery documentation</a>.</p> <h3 id=11plan-for-landing-zone-network-segmentation>11.Plan for Landing Zone Network Segmentation<a class=headerlink href=#11plan-for-landing-zone-network-segmentation title="Permanent link">⚓︎</a></h3> <p>NSGs were discussed briefly in a previous sub-section. NSGs help protect traffic across subnets, as well as east/west traffic across the platform (traffic between landing zones) while application security groups at the subnet-level NSGs help protect multitier VMs within the landing zone. The detailed design considerations and recommendations for the use of NSGs and other controls to drive a network zero-trust implementation can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation>Plan for landing zone network segmentation documentation</a>.</p> <h3 id=12plan-for-network-encryption>12.Plan for Network Encryption<a class=headerlink href=#12plan-for-network-encryption title="Permanent link">⚓︎</a></h3> <p>While two network topologies have been briefly discussed in earlier sub-sections, encryption of traffic between on-premises and Azure has not been covered. While a VPN gateway provides encryption of data passing through the IPSEC tunnel, an ExpressRoute gateway does not provide any encryption by default. The design considerations and recommendations for providing encryption with ExpressRoute gateways and the Virtual WAN gateways can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/define-network-encryption-requirements>Plan for Network Encryption documentation</a>.</p> <h3 id=13plan-for-traffic-inspection>13.Plan for Traffic Inspection<a class=headerlink href=#13plan-for-traffic-inspection title="Permanent link">⚓︎</a></h3> <p>In many industries, organizations require that traffic in Azure is mirrored to a network packet collector for deep inspection and analysis. This requirement typically focuses on inbound and outbound internet traffic. Network Watcher can capture packets although for a limited window of 5 hours. Third party tools are recommended for deep packet inspection. The detailed design considerations and recommendations for mirroring or tapping traffic within Azure Virtual Network can be obtained from <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-traffic-inspection>Plan for Traffic Inspection documentation</a>.</p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../orgmgmt/ class="md-footer__link md-footer__link--prev" aria-label="Previous: 3.Organization Mgmt" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> 3.Organization Mgmt </div> </div> </a> <a href=../monitoringmgmt/ class="md-footer__link md-footer__link--next" aria-label="Next: 5.Monitoring & Mgmt" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> 5.Monitoring & Mgmt </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> <a href=/about/ >Copyright (C) 2021 Kyndryl</a>. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.kyndryl.net/OCTO/azure/ target=_blank rel=noopener title="FEEDBACK & ISSUES" class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tabs.link", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.e99e714c.min.js", "version": null}</script> <script src=../../assets/javascripts/bundle.8697d190.min.js></script> </body> </html>