<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Create a branded static site from a set of Markdown files to host the documentation of your Open Source or commercial project"><meta name=author content="OCTO CCoE"><link href=https://github.kyndryl.net/OCTO/azure/automation/lighthouse/lh-enableguide/ rel=canonical><link rel=icon href=../../../kyndryl2.png><meta name=generator content="mkdocs-1.2.2, mkdocs-material-7.3.0"><title>LightHouse Enablement - Kyndrl Solution Guidance for Azure Services</title><link rel=stylesheet href=../../../assets/stylesheets/main.55b1b295.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,400,400i,700%7CIBM+Plex+Mono&display=fallback"><style>:root{--md-text-font-family:"IBM Plex Sans";--md-code-font-family:"IBM Plex Mono"}</style><link rel=stylesheet href=../../../extra.css><link rel=stylesheet href=../../../extra-pagesize.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=blue> <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#azure-lighthouse-enablement-guide class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Kyndrl Solution Guidance for Azure Services" class="md-header__button md-logo" aria-label="Kyndrl Solution Guidance for Azure Services" data-md-component=logo> <img src=../../../kyndryl2.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Kyndrl Solution Guidance for Azure Services </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> LightHouse Enablement </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.kyndryl.net/OCTO/azure/issues title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> FEEDBACK/ISSUES </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../stratplan/stratplanoverview/ class=md-tabs__link> Adoption & Design </a> </li> <li class=md-tabs__item> <a href=../../../resource-service/compute/ class=md-tabs__link> Azure Resources & Services </a> </li> <li class=md-tabs__item> <a href=../../../lzdesignsample1/wldescription/ class=md-tabs__link> Examples - Design & Implementation </a> </li> <li class=md-tabs__item> <a href=../../automation/automation-usecases/ class="md-tabs__link md-tabs__link--active"> Operations Automation (IN PROGRESS) </a> </li> <li class=md-tabs__item> <a href=../../../about/1authors/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Kyndrl Solution Guidance for Azure Services" class="md-nav__button md-logo" aria-label="Kyndrl Solution Guidance for Azure Services" data-md-component=logo> <img src=../../../kyndryl2.png alt=logo> </a> Kyndrl Solution Guidance for Azure Services </label> <div class=md-nav__source> <a href=https://github.kyndryl.net/OCTO/azure/issues title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> FEEDBACK/ISSUES </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> Home <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Home data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../../home/scope/ class=md-nav__link> Scope </a> </li> <li class=md-nav__item> <a href=../../../home/prereq-learning/ class=md-nav__link> Pre-Requisite Learning </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Adoption & Design <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Adoption & Design" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Adoption & Design </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1 type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1> Strategy & Planning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Strategy & Planning" data-md-level=2> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Strategy & Planning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../stratplan/stratplanoverview/ class=md-nav__link> Strategy & Planning Overview </a> </li> <li class=md-nav__item> <a href=../../../stratplan/adoptionstrategy/ class=md-nav__link> Cloud Adoption Strategy </a> </li> <li class=md-nav__item> <a href=../../../stratplan/adoptionplan/ class=md-nav__link> Plan </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Landing Zone Design <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Landing Zone Design" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Landing Zone Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../lzdesign/lzdesignoverview/ class=md-nav__link> Overview & Scope </a> </li> <li class=md-nav__item> <a href=../../../lzdesign/lzdesignapproach/ class=md-nav__link> Design Approach </a> </li> <li class=md-nav__item> <a href=../../../lzdesign/eaenrolment/ class=md-nav__link> 1.Enterprise Enrollment </a> </li> <li class=md-nav__item> <a href=../../../lzdesign/iam/ class=md-nav__link> 2.Identity & Access </a> </li> <li class=md-nav__item> <a href=../../../lzdesign/orgmgmt/ class=md-nav__link> 3.Organization Mgmt </a> </li> <li class=md-nav__item> <a href=../../../lzdesign/nwtopology/ class=md-nav__link> 4.Network </a> </li> <li class=md-nav__item> <a href=../../../lzdesign/monitoringmgmt/ class=md-nav__link> 5.Monitoring & Mgmt </a> </li> <li class=md-nav__item> <a href=../../../lzdesign/govcomp/ class=md-nav__link> 6.Governance & Compliance </a> </li> <li class=md-nav__item> <a href=../../../lzdesign/bcdr/ class=md-nav__link> 7.Backup & DR </a> </li> <li class=md-nav__item> <a href=../../../lzdesign/platformauto/ class=md-nav__link> 8.Platform Automation </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> Automations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Automations data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Automations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../automation/automation-framework.md class=md-nav__link> Automation Framework </a> </li> <li class=md-nav__item> <a href=../../automation/automation-architecture/ class=md-nav__link> Automation Architecture </a> </li> <li class=md-nav__item> <a href=../../automation/makemanage/ class=md-nav__link> Make Manage Automation </a> </li> <li class=md-nav__item> <a href=../../automation/azure-automationoptions/ class=md-nav__link> Azure Automation Options </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Azure LightHouse <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Azure LightHouse" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Azure LightHouse </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> LightHouse Enablement <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> LightHouse Enablement </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#azure-lighthouse-overview class=md-nav__link> Azure LightHouse Overview </a> <nav class=md-nav aria-label="Azure LightHouse Overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#azure-lighthouse-concept class=md-nav__link> Azure LightHouse Concept </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#enablement-steps-on-service-providersp-tenant class=md-nav__link> Enablement Steps - on Service Provider(SP) Tenant </a> <nav class=md-nav aria-label="Enablement Steps - on Service Provider(SP) Tenant"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-define-access-controlrbac-roles-for-service-provider class=md-nav__link> Step 1 - Define Access Control/RBAC Roles for Service Provider </a> <nav class=md-nav aria-label="Step 1 - Define Access Control/RBAC Roles for Service Provider"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kyndryl-use-case-for-rbac class=md-nav__link> Kyndryl Use Case for RBAC </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-2-create-aad-groups class=md-nav__link> Step 2 - Create AAD Groups </a> <nav class=md-nav aria-label="Step 2 - Create AAD Groups"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-2a-add-users-under-the-above-groups class=md-nav__link> Step 2a - Add Users under the above groups </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-3-define-service-provide-offer-name class=md-nav__link> Step 3 - Define Service Provide Offer Name </a> </li> <li class=md-nav__item> <a href=#step-4-identify-tenant-id class=md-nav__link> Step 4 - Identify Tenant ID </a> </li> <li class=md-nav__item> <a href=#step-5-create-arm-template class=md-nav__link> Step 5 - Create ARM Template </a> <nav class=md-nav aria-label="Step 5 - Create ARM Template"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#defining-additional-roles-aad-groups-in-arm-template class=md-nav__link> Defining additional roles &amp; AAD groups in ARM template </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client-onboardingenablement-on-customer-tenant class=md-nav__link> Client Onboarding/Enablement - on customer Tenant </a> </li> <li class=md-nav__item> <a href=#validation-on-customer-tenant class=md-nav__link> Validation - on customer Tenant </a> </li> <li class=md-nav__item> <a href=#validation-on-sp-tenant class=md-nav__link> Validation - on SP Tenant </a> <nav class=md-nav aria-label="Validation - on SP Tenant"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> Troubleshooting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#delegating-management-groups-vs-subscriptions class=md-nav__link> Delegating Management Groups vs Subscriptions </a> </li> <li class=md-nav__item> <a href=#using-lighthouse-with-azure-aad-pim-preview class=md-nav__link> Using LightHouse with Azure AAD PIM (Preview) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../lh-adminguide/ class=md-nav__link> LightHouse Administration </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Azure Resources & Services <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Azure Resources & Services" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Azure Resources & Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../resource-service/compute/ class=md-nav__link> Azure Compute </a> </li> <li class=md-nav__item> <a href=../../../resource-service/vmagents/ class=md-nav__link> VM Agents </a> </li> <li class=md-nav__item> <a href=../../../resource-service/storage/ class=md-nav__link> Azure Storage </a> </li> <li class=md-nav__item> <a href=../../../resource-service/aks/ class=md-nav__link> Azure Kubernetes Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Examples - Design & Implementation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Examples - Design & Implementation" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Examples - Design & Implementation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_1 type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1> Landing Zone Design - Sample Workload 1 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Landing Zone Design - Sample Workload 1" data-md-level=2> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Landing Zone Design - Sample Workload 1 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../lzdesignsample1/wldescription/ class=md-nav__link> Workload Description </a> </li> <li class=md-nav__item> <a href=../../../lzdesignsample1/eaenrol/ class=md-nav__link> 1.Enterprise Enrollment & Azure AD Tenants </a> </li> <li class=md-nav__item> <a href=../../../lzdesignsample1/idaccess/ class=md-nav__link> 2.Identity & Access Management </a> </li> <li class=md-nav__item> <a href=../../../lzdesignsample1/organdmgmt/ class=md-nav__link> 3.Organization & Management Group </a> </li> <li class=md-nav__item> <a href=../../../lzdesignsample1/nwtopo/ class=md-nav__link> 4.Network Topology & Connectivity </a> </li> <li class=md-nav__item> <a href=../../../lzdesignsample1/monitoringmgmt/ class=md-nav__link> 5.Monitoring & Management </a> </li> <li class=md-nav__item> <a href=../../../lzdesignsample1/backupdr/ class=md-nav__link> 6.Business Continuity & Disaster Recovery </a> </li> <li class=md-nav__item> <a href=../../../lzdesignsample1/govcomp/ class=md-nav__link> 7.Governance & Compliance </a> </li> <li class=md-nav__item> <a href=../../../lzdesignsample1/platformauto/ class=md-nav__link> 8.Platform Automation & DevOps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Virtual WAN - Design and Implementation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Virtual WAN - Design and Implementation" data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Virtual WAN - Design and Implementation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../virtualwan/overview/ class=md-nav__link> Overview and Link to Details </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5> Operations Automation (IN PROGRESS) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operations Automation (IN PROGRESS)" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Operations Automation (IN PROGRESS) </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_1 type=checkbox id=__nav_5_1> <label class=md-nav__link for=__nav_5_1> Automations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Automations data-md-level=2> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> Automations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../automation/automation-usecases/ class=md-nav__link> Automation UseCases </a> </li> <li class=md-nav__item> <a href=../../automation/automation-architecture/ class=md-nav__link> Automation Architecture </a> </li> <li class=md-nav__item> <a href=../../automation/makemanage/ class=md-nav__link> Make Manage Automation </a> </li> <li class=md-nav__item> <a href=../../automation/azure-automationoptions/ class=md-nav__link> Azure Automation Options </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_2 type=checkbox id=__nav_5_2 checked> <label class=md-nav__link for=__nav_5_2> Azure LightHouse <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Azure LightHouse" data-md-level=2> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Azure LightHouse </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> LightHouse Enablement <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> LightHouse Enablement </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#azure-lighthouse-overview class=md-nav__link> Azure LightHouse Overview </a> <nav class=md-nav aria-label="Azure LightHouse Overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#azure-lighthouse-concept class=md-nav__link> Azure LightHouse Concept </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#enablement-steps-on-service-providersp-tenant class=md-nav__link> Enablement Steps - on Service Provider(SP) Tenant </a> <nav class=md-nav aria-label="Enablement Steps - on Service Provider(SP) Tenant"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-define-access-controlrbac-roles-for-service-provider class=md-nav__link> Step 1 - Define Access Control/RBAC Roles for Service Provider </a> <nav class=md-nav aria-label="Step 1 - Define Access Control/RBAC Roles for Service Provider"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kyndryl-use-case-for-rbac class=md-nav__link> Kyndryl Use Case for RBAC </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-2-create-aad-groups class=md-nav__link> Step 2 - Create AAD Groups </a> <nav class=md-nav aria-label="Step 2 - Create AAD Groups"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-2a-add-users-under-the-above-groups class=md-nav__link> Step 2a - Add Users under the above groups </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-3-define-service-provide-offer-name class=md-nav__link> Step 3 - Define Service Provide Offer Name </a> </li> <li class=md-nav__item> <a href=#step-4-identify-tenant-id class=md-nav__link> Step 4 - Identify Tenant ID </a> </li> <li class=md-nav__item> <a href=#step-5-create-arm-template class=md-nav__link> Step 5 - Create ARM Template </a> <nav class=md-nav aria-label="Step 5 - Create ARM Template"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#defining-additional-roles-aad-groups-in-arm-template class=md-nav__link> Defining additional roles &amp; AAD groups in ARM template </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client-onboardingenablement-on-customer-tenant class=md-nav__link> Client Onboarding/Enablement - on customer Tenant </a> </li> <li class=md-nav__item> <a href=#validation-on-customer-tenant class=md-nav__link> Validation - on customer Tenant </a> </li> <li class=md-nav__item> <a href=#validation-on-sp-tenant class=md-nav__link> Validation - on SP Tenant </a> <nav class=md-nav aria-label="Validation - on SP Tenant"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> Troubleshooting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#delegating-management-groups-vs-subscriptions class=md-nav__link> Delegating Management Groups vs Subscriptions </a> </li> <li class=md-nav__item> <a href=#using-lighthouse-with-azure-aad-pim-preview class=md-nav__link> Using LightHouse with Azure AAD PIM (Preview) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../lh-adminguide/ class=md-nav__link> LightHouse Administration </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> About <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=About data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../about/1authors/ class=md-nav__link> Contributors </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#azure-lighthouse-overview class=md-nav__link> Azure LightHouse Overview </a> <nav class=md-nav aria-label="Azure LightHouse Overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#azure-lighthouse-concept class=md-nav__link> Azure LightHouse Concept </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#enablement-steps-on-service-providersp-tenant class=md-nav__link> Enablement Steps - on Service Provider(SP) Tenant </a> <nav class=md-nav aria-label="Enablement Steps - on Service Provider(SP) Tenant"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-define-access-controlrbac-roles-for-service-provider class=md-nav__link> Step 1 - Define Access Control/RBAC Roles for Service Provider </a> <nav class=md-nav aria-label="Step 1 - Define Access Control/RBAC Roles for Service Provider"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kyndryl-use-case-for-rbac class=md-nav__link> Kyndryl Use Case for RBAC </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-2-create-aad-groups class=md-nav__link> Step 2 - Create AAD Groups </a> <nav class=md-nav aria-label="Step 2 - Create AAD Groups"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-2a-add-users-under-the-above-groups class=md-nav__link> Step 2a - Add Users under the above groups </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-3-define-service-provide-offer-name class=md-nav__link> Step 3 - Define Service Provide Offer Name </a> </li> <li class=md-nav__item> <a href=#step-4-identify-tenant-id class=md-nav__link> Step 4 - Identify Tenant ID </a> </li> <li class=md-nav__item> <a href=#step-5-create-arm-template class=md-nav__link> Step 5 - Create ARM Template </a> <nav class=md-nav aria-label="Step 5 - Create ARM Template"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#defining-additional-roles-aad-groups-in-arm-template class=md-nav__link> Defining additional roles &amp; AAD groups in ARM template </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client-onboardingenablement-on-customer-tenant class=md-nav__link> Client Onboarding/Enablement - on customer Tenant </a> </li> <li class=md-nav__item> <a href=#validation-on-customer-tenant class=md-nav__link> Validation - on customer Tenant </a> </li> <li class=md-nav__item> <a href=#validation-on-sp-tenant class=md-nav__link> Validation - on SP Tenant </a> <nav class=md-nav aria-label="Validation - on SP Tenant"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> Troubleshooting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#delegating-management-groups-vs-subscriptions class=md-nav__link> Delegating Management Groups vs Subscriptions </a> </li> <li class=md-nav__item> <a href=#using-lighthouse-with-azure-aad-pim-preview class=md-nav__link> Using LightHouse with Azure AAD PIM (Preview) </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=azure-lighthouse-enablement-guide>Azure LightHouse Enablement Guide<a class=headerlink href=#azure-lighthouse-enablement-guide title="Permanent link">⚓︎</a></h1> <h2 id=azure-lighthouse-overview>Azure LightHouse Overview<a class=headerlink href=#azure-lighthouse-overview title="Permanent link">⚓︎</a></h2> <p>Azure Lighthouse is designed to provide a secure, granular way for Service Providers(SP) to gain single token access to customer environments using the principles of least privilege to help easily manage multiple customer environments and automate management tasks at scale.</p> <p>Azure LightHouse helps service providers like Kyndryl in effective governance management across customers.</p> <h3 id=azure-lighthouse-concept>Azure LightHouse Concept<a class=headerlink href=#azure-lighthouse-concept title="Permanent link">⚓︎</a></h3> <ul> <li> <p>Light House allows authorized users in one Azure Active Directory (Azure AD) tenant, referred as <strong>Service Provider(SP)</strong>, perform management operations across different Azure AD tenants belonging to different clients, referred as <strong>Customer/Managed Customer</strong></p> </li> <li> <p>Azure Light House operates on the concept of “<strong>Delegated Resource Management</strong>” which enables logical projection of resources from one Azure tenant onto another tenant. This concept creates <strong>logical control plane access</strong> for the service provider onto <strong>customer resources</strong> thereby providing the service provider ability to view and manage custome resources</p> </li> <li> <p>Customer resources to be projected can be at <strong>subscription and/or Resource Group level only</strong> and NOT at the customer tenant level. (Delegation at Management Group has been introduced - Read Note below)</p> </li> </ul> <p><center><img style=height:60%;width:80% src=../images/lh-concept.png></center></p> <p>**How it works-Overview **: When LightHouse is "enabled" on a customer subscription, specifying the managed service provider's Azure AD tenant details, Azure backbone framework establishes connectivity between SP &amp; customer resources, using VNET and other services which is transparent and not visible to both the service provider and the customer.</p> <ul> <li> <p>Once connectivity is established, customer resources appear in the Light House menu as "customers".</p> </li> <li> <p>Type of access for the SP is defined during the enablement process. It is important to note that client has visibility, as well as can control what roles (Azure Roles) are granted to the SP. However the client may not have the ability to control which user from the SP, has access to their resources (explained further in Access Control/RBAC section)</p> </li> <li> <p>Also important to note is the fact that there are no Users/Groups need to be defined for SP on the customer Tenant, but only "Azure Roles" are assigned to the SP</p> </li> <li> <p>"Owner" Role cannot be assigned to a SP - this is by design and cannot be overridden. </p> </li> <li> <p>This enablement step has to performed on every subscription a customer has.</p> </li> <li> <p>** Cost**: Light House capability is included by default in every subscription. Any subscription can be used as a Service Provider(SP) or customer, at no cost!</p> </li> <li> <p>More details on <a href=https://docs.microsoft.com/en-us/azure/lighthouse/concepts/architecture>Azure Light House</a></p> </li> </ul> <h2 id=enablement-steps-on-service-providersp-tenant>Enablement Steps - on Service Provider(SP) Tenant<a class=headerlink href=#enablement-steps-on-service-providersp-tenant title="Permanent link">⚓︎</a></h2> <p>There are 2 ways for LightHouse enablement on the Service Provider Tenant: 1. Publish a Azure marketplace managed service offer - and the customer can subscribe to this offer through Azure marketplace. 2. Create ARM template - which will then be run on the client subscription to become a Light House customer for the SP.</p> <p>For Kyndryl accounts, <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/2 title="GitHub Issue: squidfunk/mkdocs-material #2">#2</a> will be used, as Kyndryl is still in the process of meeting the pre-reqs to publish any offers in Azure marketplace</p> <p>There are 4 elements that need to be defined in the ARM template:</p> <ol> <li>Azure Role(s) that will be used to manage the customer</li> <li>Azure AD(AAD) Groups associated with the defined Azure Role. Though users also can be associated with the roles, this will be an administrative overhead and hence should NOT be used for Kyndryl managed clients.</li> <li><strong>Unique</strong> Service Provider Offer Name</li> <li>Azure Active Directory Tenant ID of the Service Provider</li> </ol> <h3 id=step-1-define-access-controlrbac-roles-for-service-provider>Step 1 - Define Access Control/RBAC Roles for Service Provider<a class=headerlink href=#step-1-define-access-controlrbac-roles-for-service-provider title="Permanent link">⚓︎</a></h3> <p>It is important to define the Azure Roles &amp; Azure AD(AAD) Groups before enablement since each time a new role needs to be added, customer has to be removed from Light House and enablement steps repeated for each customer subscription.</p> <h4 id=kyndryl-use-case-for-rbac>Kyndryl Use Case for RBAC<a class=headerlink href=#kyndryl-use-case-for-rbac title="Permanent link">⚓︎</a></h4> <p>There will be various Kyndryl support teams performing different operations for a customer.<br> An AAD group has to defined for each of the support teams, with associated AZ roles. These groups can be customer specific (recommended) OR can be shared groups to manage multiple customers, depending on the delivery team model and client needs.</p> <p>For Kyndryl managed clients, roles defined in <a href=https://pages.github.kyndryl.net/OCTO/azure/lzdesign/iam/ >Azure Solution guidance for Landing Zones</a> should be followed, which means AAD groups need to be created for each of the recommended roles (except Platform Admin group)</p> <p>However, for this example, let's assume that there will be 2 Roles defined to manage account named "mcm".</p> <ul> <li>Account Name: mcm (this is the 3 char BlueID account code assigned to the account)</li> <li>Roles required to manage this account: </li> <li><strong>Contributor</strong> - who can perform all actions on "mcm" customer except user administration</li> <li><strong>Reader</strong> - who can perform read actions for all resources for the customer.</li> </ul> <h3 id=step-2-create-aad-groups>Step 2 - Create AAD Groups<a class=headerlink href=#step-2-create-aad-groups title="Permanent link">⚓︎</a></h3> <p>Based on above, two AAD groups will have to be defined in the SP tenant, following this naming standard below, where "acc" is the 3 char account code.</p> <p><center><img style=height:60%;width:80% src=../images/lh-aadgroupname.png></center></p> <p><strong>mcm_lighthouse_contributors</strong>. <strong>mcm_lighthouse_readers</strong>. </p> <p><strong>IMPORTANT:</strong> a) There is NO need to assign any Azure role(s) to the above groups. Roles will be assigned in the ARM template for each customer, by each customer. b) Since no roles are assigned here, users added to this group will NOT have any privileges on the SP subscription, but only on customer subscriptions (<strong>FOR DISCUSSION WITH ALWYN</strong>)</p> <p>Create other AAD groups as needed for your accounts, ensuring that the group name includes the Azure role name in the 3<sup>rd</sup> identifier. This is to make easier RBAC management.</p> <h4 id=step-2a-add-users-under-the-above-groups>Step 2a - Add Users under the above groups<a class=headerlink href=#step-2a-add-users-under-the-above-groups title="Permanent link">⚓︎</a></h4> <p>Add users to appropriate respective groups based on their roles to be performed. For example an user performing a "contributor" role should be added to the mcm_lighthouse_contributors AAD group.</p> <h3 id=step-3-define-service-provide-offer-name>Step 3 - Define Service Provide Offer Name<a class=headerlink href=#step-3-define-service-provide-offer-name title="Permanent link">⚓︎</a></h3> <p>Any "unique" name can be used to define Service Provider offer. However, Kyndryl managed environments should follow the below naming standard. This naming standard will allow the customer to identify who is their SP, as well as help Kndryl teams to identify which Azure instance the customer is being managed from.</p> <p><strong>SP Offer Name Standard</strong>: <strong>Company-DeliveryOrg-region-Instance/TenantReference</strong>.<br> Example: <strong><em>kyndryl-mcms-na-inst001</em></strong></p> <p><strong>Note</strong> that there will be only one SP Offer in a SP Tenant. Though there is no technical limitation, there is no need to define more than one SP offer in a SP tenant.</p> <h3 id=step-4-identify-tenant-id>Step 4 - Identify Tenant ID<a class=headerlink href=#step-4-identify-tenant-id title="Permanent link">⚓︎</a></h3> <p>After login to Azure portal for SP, open cloud shell window and run the following command to run the identify the Tenant ID:</p> <p><strong>az account show</strong>, which will list the Tenant ID.</p> <p><strong>NOTE</strong>: this step is not needed when the template is created through portal UI, but given here for reference.</p> <h3 id=step-5-create-arm-template>Step 5 - Create ARM Template<a class=headerlink href=#step-5-create-arm-template title="Permanent link">⚓︎</a></h3> <p>Microsoft provided <a href=https://github.com/Azure/Azure-Lighthouse-samples/tree/master/templates/delegated-resource-management/subscription>sample ARM templates</a> can be used with above details inserted. </p> <p>The same template can also be created through the UI, and UI is recommended, for ease of use. From the Azure Light House portal navigate to <strong><em>Azure Light House &rarr; Manage your customers &rarr; Create ARM Template</em></strong> and make the following choices as shown below:</p> <p><center><img style=height:30%;width:60% src=../images/lh-spofferscreen.png></center></p> <p>Select <strong>"Add Authorization"</strong>, and define the roles as follows: <center><img style=height:30%;width:60% src=../images/lh-spofferauthscreen.png></center></p> <p>NOTE: <strong>Principal ID</strong>: Select the above AAD group defined for contributor role (mcm_lighthouse_contributor). <strong>Display Name</strong>: Select/Type AAD group name here(mcm_lighthouse_contributors). Though anyname can be specified, it is recommended to follow the AAD group name for easier identification and management through LightHouse UI.<br> <strong>Role</strong>: Select "<strong>Contributor</strong>" Role. <br> <strong>Add Additional Roles</strong>.<br> Repeat <strong>"Add Authorization"</strong>, to define the "Resource Policy Contributor, reader" roles, against respective groups as shown below: <center><img style=height:30%;width:60% src=../images/lh-spauthorizations.png></center></p> <p>After above step choose "<strong>View template</strong>" and <strong>download</strong> the template. </p> <p><strong>IMPORTANT</strong>: When the customer runs this template on a specific subscription, above defined roles are granted for the respective subscription(s) to the SP.</p> <p>Refer this <a href=https://github.kyndryl.net/OCTO/azure/blob/main/docs/lighthouse/images/coe-lh-template-abc.json>template</a> created from the above example.</p> <p>All the above constructs (Tenant ID, SP Offer Name, Authorization Roles) can be seen in the ARM template:</p> <p><center><img style=height:60%;width:80% src=../images/lh-armtemplate.png></center></p> <h4 id=defining-additional-roles-aad-groups-in-arm-template>Defining additional roles &amp; AAD groups in ARM template<a class=headerlink href=#defining-additional-roles-aad-groups-in-arm-template title="Permanent link">⚓︎</a></h4> <p>Though the above method using Azure portal can be followed for adding new roles to an existing customer, OR to add new customers, the same can be accomplished by updating an existing template.</p> <p>For example, to add a new customer ("abc") on the same SP tenant, update only the sections as marked below:</p> <p><center><img style=height:60%;width:80% src=../images/lh-armtemplateupdate.png></center></p> <p>a. <strong>principalIDDisplayName</strong> Create an AAD group with the name as defined "abc_ lighthouse_ contributors". <br> b. <strong>principalID</strong>: Identify the object ID of the AAD group thru UI or CLI <em>(az ad group show --group "abc_ lighthouse_ contributors" --query "objectId")</em> and update the value below. </p> <p>No need to change any other entries, unless new roles need to be added. If a new role need to be added for example, "Backup Contributor" role, then define a new AAD group, identify the object ID using above command, as well as identify the Role Definition object ID <em>(az role definition list --name "Backup Contributor" | grep name)</em> and define the "roleDefinitionID" entry with this value.</p> <p>Refer Microsoft document for additional details on creating/updating <a href=https://docs.microsoft.com/en-us/azure/lighthouse/how-to/onboard-customer#create-your-template-in-the-azure-portal>ARM templates</a> </p> <h2 id=client-onboardingenablement-on-customer-tenant>Client Onboarding/Enablement - on customer Tenant<a class=headerlink href=#client-onboardingenablement-on-customer-tenant title="Permanent link">⚓︎</a></h2> <p><strong>Pre-Requisite</strong>: Customer need to be made aware of the LightHouse model, and that the customer will be granting all defined "roles" to Kyndryl by running the ARM template. <strong>(NOTE: Client Justification PPT/DOC to be created in Sprint 3)</strong></p> <p>After the above is completed, send the above template to the customer with below instructions:</p> <p>1) Login to Azure portal. <br> 2) This template should be run by a customer user with "Owner" privilege to subscription. <br> 3) Copy(drag&amp;drop) the template to Azure Cloud Shell. <br> 4) On cloud shell, run "az account set --subscription <em>subscription ID</em> (eg.4b4ea0d2-145d-4716-b701-8419d8a1f002)", where the subscription ID should be the ID of the subscription which should be managed by Kyndryl. <br> 5) Validate CLI/Cloud shell subscription context using "az account show", which should list the subscription for which delegation is being granted to Kyndryl. <br> 6) Run the following command: </p> <p>az deployment sub create --name <strong><em>somename</em></strong> --location <strong><em>somedestination</em></strong> --template-file <strong><em>ARMTemplateFileName.json</em></strong> --verbose. </p> <p>7) <strong>Repeat</strong> steps <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/4 title="GitHub Issue: squidfunk/mkdocs-material #4">#4</a> to <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/7 title="GitHub Issue: squidfunk/mkdocs-material #7">#7</a> for <strong>each client subscription</strong> that should be managed by Kyndryl. </p> <h2 id=validation-on-customer-tenant>Validation - on customer Tenant<a class=headerlink href=#validation-on-customer-tenant title="Permanent link">⚓︎</a></h2> <p>Navigate to Azure Light House &rarr; View Service Provider Offers &rarr; Service Provider Offers, you should see service provide offer, similar to screen shot below. There will be a row for each subscription</p> <p><center><img style=height:60%;width:80% src=../images/lh-customer-spofferscreen.png></center></p> <p>Delegations section shows additional details including Subscription names &amp; Role assignments: <center><img style=height:60%;width:80% src=../images/lh-customer-delegationscreen.png></center></p> <h2 id=validation-on-sp-tenant>Validation - on SP Tenant<a class=headerlink href=#validation-on-sp-tenant title="Permanent link">⚓︎</a></h2> <p>It may take a few mins for the customers to appear on the SP portal, as shown below:</p> <p><center><img style=height:60%;width:80% src=../images/lh-spscreen.png></center></p> <h3 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">⚓︎</a></h3> <p>If the customer is not visible on the SP tenant, the most common problem is to select the subscriptions in your profile. Though this should happen automatically, most times it does not.</p> <p>Select your <em>user profile &rarr; Switch directory</em> &rarr; and select all subscriptions under "Current + delegated directories":</p> <p><center><img style=height:60%;width:80% src=../images/lh-sp-delegateddirectory.png></center></p> <p>Repeat the same(select all subscriptions) from "Subscriptions" pull down beneath the above menu</p> <p>Continue to <a href=https://pages.github.kyndryl.net/OCTO/azure/lighthouse/lh-adminguide/ >Light House Admin Section...</a></p> <h2 id=delegating-management-groups-vs-subscriptions>Delegating Management Groups vs Subscriptions<a class=headerlink href=#delegating-management-groups-vs-subscriptions title="Permanent link">⚓︎</a></h2> <p>Instead or on-boarding every subscription from a client, It is possible to delegate a Management Group on the client side.</p> <p>For this to work, a management group should be created on customer tenant - with all the Kyndryl managed subscriptions be defined under this group. And then delegate the management group to the Service Provider. Refer <a href=https://docs.microsoft.com/en-us/azure/lighthouse/how-to/onboard-management-group>Microsoft docs</a> on how to achieve this.</p> <p>However, there may be challenges with this approach, since Kyndryl managed subscriptions, in most cases, are already be part of another management group designed &amp; defined for other business reasons by the client. Hence use this model as appropriate.</p> <h2 id=using-lighthouse-with-azure-aad-pim-preview>Using LightHouse with Azure AAD PIM (Preview)<a class=headerlink href=#using-lighthouse-with-azure-aad-pim-preview title="Permanent link">⚓︎</a></h2> <p>Some customers may not be comfortable with LightHouse's current model whereby anyone from the SP can perform any action on the client subscriptions without any controls, after the initial delegation.</p> <p>Microsoft recently announced the public preview of <a href=https://azure.microsoft.com/en-us/blog/privileged-identity-management-with-azure-lighthouse-enables-zero-trust/ >Azure Lighthouse support for Azure AAD PIM</a>. </p> <p>This integration enforces the the principle of least privilege through through just-enough and just-in-time (JIT) access model, facilitated by Azure AD PIM.</p> <p>From a Kyndryl perspective, PIM (JIT, Just Enough) has to be studied at the broader level beyond Light House, which will be addressed by the security competency.</p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../automation/azure-automationoptions/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Azure Automation Options" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Azure Automation Options </div> </div> </a> <a href=../lh-adminguide/ class="md-footer__link md-footer__link--next" aria-label="Next: LightHouse Administration" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> LightHouse Administration </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> <a href=/about/ >Copyright (C) 2021 Kyndryl</a>. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.kyndryl.net/OCTO/azure/ target=_blank rel=noopener title="FEEDBACK & ISSUES" class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.tabs.link", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.e99e714c.min.js", "version": null}</script> <script src=../../../assets/javascripts/bundle.8697d190.min.js></script> </body> </html>